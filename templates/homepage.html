<script type="text/javascript">
    $(document).ready(function(){
        $(".error").hide();

        Dajaxice.microsite.homepage_available_options(function(data) {
            console.log(data);
            var links = data.links;
            var options = data.options;
            options.unshift({
                name: "选择链接",
                url: "#"
            });
            for(var i = 0; i < 4; i++) {
                $select = $("#id_link" + (i + 1));
                var html = "";
                for(var j = 0; j < options.length; j++) {
                    var option = options[j];
                    if(option.url === links[i]) {
                        html += "<option selected='selected' " + 
                                    "value='" + option.url + "'>" + 
                                    option.name+ "</option>";
                    } else {
                        html += "<option value='" + option.url + "'>" + 
                                    option.name+ "</option>";
                    }
                }
                $select.html(html);
            }
        });
        
        $("select").focus(function(){
            var pic_display = $(this).parents("tr:first").prevAll("tr:eq(1)").find("div[class='ajax-upload-preview-area']").css("display");
            if(pic_display == 'none'){
                $(this).next(".error").show();
                return;
            }
        });
    });
</script>

<div class="navbar" style="margin-bottom:0;">
    <div class="navbar-inner">
        <p class="navbar-text">页面内容设置</p>
    </div>
</div>
<table class="table">
    <tbody>
    <tr><th><span style="color:red;">*</span>{{ form.name.label }}</th><td>{{ form.name }}{{ form.name.errors }}</td></tr>
    <tr><th><span style="color:red;">*</span>{{ form.template_type.label }}</th><td>{{ form.template_type }}{{ form.template_type.errors }}</td></tr>
    <tr><th><span style="color:red;">*</span>{{ form.pic1.label }}</th><td>{{ form.pic1 }}<span class="help-inline">{{form.pic1.help_text}}</span>{{ form.pic1.errors }}</td></tr>
    <tr><th>{{ form.exp1.label }}</th><td>{{ form.exp1 }}{{ form.exp1.errors }}</td></tr>
    <tr><th>{{ form.link1.label }}</th><td>{{ form.link1 }}{{ form.link1.errors }}</td></tr>
    <tr><th>{{ form.pic2.label }}</th><td>{{ form.pic2 }}{{ form.pic2.errors }}</td></tr>
    <tr><th>{{ form.exp2.label }}</th><td>{{ form.exp2 }}{{ form.exp2.errors }}</td></tr>
    <tr><th>{{ form.link2.label }}</th><td>{{ form.link2 }}{{ form.link2.errors }}</td></tr>
    <tr><th>{{ form.pic3.label }}</th><td>{{ form.pic3 }}{{ form.pic3.errors }}</td></tr>
    <tr><th>{{ form.exp3.label }}</th><td>{{ form.exp3 }}{{ form.exp3.errors }}</td></tr>
    <tr><th>{{ form.link3.label }}</th><td>{{ form.link3 }}{{ form.link3.errors }}</td></tr>
    <tr><th>{{ form.pic4.label }}</th><td>{{ form.pic4 }}{{ form.pic4.errors }}</td></tr>
    <tr><th>{{ form.exp4.label }}</th><td>{{ form.exp4 }}{{ form.exp4.errors }}</td></tr>
    <tr><th>{{ form.link4.label }}</th><td>{{ form.link4 }}{{ form.link4.errors }}</td></tr>
    </tbody>
</table>

{% include "weixin_message_section.html" %}
